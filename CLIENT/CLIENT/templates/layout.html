<!DOCTYPE html>
<html lang="en-US" dir="ltr" data-navigation-type="default" data-navbar-horizontal-shape="default">

  <meta http-equiv="content-type" content="text/html;charset=utf-8" />
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <!-- ===============================================-->
    <!--    Document Title-->
    <!-- ===============================================-->
    <title>{{ title }}</title>

    <!-- ===============================================-->
    <!--    Favicons-->
    <!-- ===============================================-->
    <link rel="apple-touch-icon" sizes="180x180" href="{{ url_for('static', filename='assets/img/favicons/favicon.ico') }}">
<link rel="icon" type="image/png" sizes="32x32" href="{{ url_for('static', filename='assets/img/favicons/favicon.ico') }}">
<link rel="icon" type="image/png" sizes="16x16" href="{{ url_for('static', filename='assets/img/favicons/favicon.ico') }}">
<link rel="shortcut icon" type="image/x-icon" href="{{ url_for('static', filename='assets/img/favicons/favicon.ico') }}">
<link rel="manifest" href="{{ url_for('static', filename='assets/img/favicons/manifest.json') }}">
<meta name="msapplication-TileImage" content="{{ url_for('static', filename='assets/img/favicons/favicon.ico') }}">
<meta name="theme-color" content="#ffffff">
<script src="{{ url_for('static', filename='vendors/simplebar/simplebar.min.js') }}"></script>
<script src="{{ url_for('static', filename='assets/js/config.js') }}"></script>

<!-- ===============================================-->
<!--    Stylesheets-->
<!-- ===============================================-->
<link href="{{ url_for('static', filename='vendors/choices/choices.min.css') }}" rel="stylesheet">
<link href="{{ url_for('static', filename='vendors/dhtmlx-gantt/dhtmlxgantt.css') }}" rel="stylesheet">
<link href="{{ url_for('static', filename='vendors/flatpickr/flatpickr.min.css') }}" rel="stylesheet">
<link rel="preconnect" href="https://fonts.googleapis.com/">
<link rel="preconnect" href="https://fonts.gstatic.com/" crossorigin="">
<link href="https://fonts.googleapis.com/css2?family=Nunito+Sans:wght@300;400;600;700;800;900&amp;display=swap" rel="stylesheet">
<link href="{{ url_for('static', filename='vendors/simplebar/simplebar.min.css') }}" rel="stylesheet">
<link rel="stylesheet" href="https://unicons.iconscout.com/release/v4.0.8/css/line.css">
<link href="{{ url_for('static', filename='assets/css/theme-rtl.min.css') }}" type="text/css" rel="stylesheet" id="style-rtl">
<link href="{{ url_for('static', filename='assets/css/theme.min.css') }}" type="text/css" rel="stylesheet" id="style-default">
<link href="{{ url_for('static', filename='assets/css/user-rtl.min.css') }}" type="text/css" rel="stylesheet" id="user-style-rtl">
<link href="{{ url_for('static', filename='assets/css/user.min.css') }}" type="text/css" rel="stylesheet" id="user-style-default">

    <script>
      var phoenixIsRTL = window.config.config.phoenixIsRTL;
      if (phoenixIsRTL) {
        var linkDefault = document.getElementById('style-default');
        var userLinkDefault = document.getElementById('user-style-default');
        linkDefault.setAttribute('disabled', true);
        userLinkDefault.setAttribute('disabled', true);
        document.querySelector('html').setAttribute('dir', 'rtl');
      } else {
        var linkRTL = document.getElementById('style-rtl');
        var userLinkRTL = document.getElementById('user-style-rtl');
        linkRTL.setAttribute('disabled', true);
        userLinkRTL.setAttribute('disabled', true);
      }
    </script>
  </head>

  <body>

  {% block content %} {% endblock %}




    <!-- ===============================================-->
    <!--    JavaScripts-->
    <!-- ===============================================-->
    <script src="{{ url_for('static', filename='vendors/simplebar/simplebar.min.js') }}"></script>
<script src="{{ url_for('static', filename='assets/js/config.js') }}"></script>
<script src="{{ url_for('static', filename='vendors/popper/popper.min.js') }}"></script>
<script src="{{ url_for('static', filename='vendors/bootstrap/bootstrap.min.js') }}"></script>
<script src="{{ url_for('static', filename='vendors/anchorjs/anchor.min.js') }}"></script>
<script src="{{ url_for('static', filename='vendors/is/is.min.js') }}"></script>
<script src="{{ url_for('static', filename='vendors/fontawesome/all.min.js') }}"></script>
<script src="{{ url_for('static', filename='vendors/lodash/lodash.min.js') }}"></script>
<script src="{{ url_for('static', filename='vendors/list.js/list.min.js') }}"></script>
<script src="{{ url_for('static', filename='vendors/feather-icons/feather.min.js') }}"></script>
<script src="{{ url_for('static', filename='vendors/dayjs/dayjs.min.js') }}"></script>
<script src="{{ url_for('static', filename='assets/js/phoenix.js') }}"></script>

<script src="{{ url_for('static', filename='vendors/choices/choices.min.js') }}"></script>
<script src="{{ url_for('static', filename='vendors/echarts/echarts.min.js') }}"></script>
<script src="{{ url_for('static', filename='vendors/dhtmlx-gantt/dhtmlxgantt.js') }}"></script>
<script src="{{ url_for('static', filename='vendors/flatpickr/flatpickr.min.js') }}"></script>
<script src="{{ url_for('static', filename='assets/js/projectmanagement-dashboard.js') }}"></script>

  <script>
document.addEventListener("DOMContentLoaded", function () {

    function showModal(type) {
        const title = type === "deposit" ? "Deposit Funds" : "Transfer Funds";
        const actionText = type === "deposit" ? "Deposit" : "Transfer";

        const modalHtml = `
            <div class="modal fade" id="${type}Modal" tabindex="-1" aria-labelledby="${type}ModalLabel" aria-hidden="true">
                <div class="modal-dialog modal-dialog-centered">
                    <div class="modal-content">
                        <div class="modal-header">
                            <h5 class="modal-title">${title}</h5>
                            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                        </div>
                        <div class="modal-body">
                            <form id="${type}Form">
                                <div class="mb-3">
                                    <label class="form-label">Amount</label>
                                    <div class="input-group">
                                        <span class="input-group-text">£</span>
                                        <input type="number" class="form-control" id="${type}Amount" placeholder="Enter amount" required>
                                    </div>
                                </div>
                                ${type === "transfer" ? `
                                <div class="mb-3">
                                    <label class="form-label">Recipient</label>
                                    <input type="text" class="form-control" id="recipient" placeholder="Enter recipient username or ID" required>
                                </div>` : ""}
                                <div class="text-end">
                                    <button type="submit" class="btn btn-primary">${actionText}</button>
                                </div>
                            </form>
                        </div>
                    </div>
                </div>
            </div>
        `;

        document.body.insertAdjacentHTML("beforeend", modalHtml);
        const modal = new bootstrap.Modal(document.getElementById(`${type}Modal`));
        modal.show();

        document.getElementById(`${type}Form`).addEventListener("submit", function (e) {
            e.preventDefault();
            processTransaction(type);
        });
    }

    function processTransaction(type) {
        const actionText = type === "deposit" ? "Deposit" : "Transfer";
        const amount = document.getElementById(`${type}Amount`).value;
        const recipient = type === "transfer" ? document.getElementById("recipient").value : null;

        if (!amount || (type === "transfer" && !recipient)) {
            alert("Please fill in all fields.");
            return;
        }

        // Disable button to prevent multiple submissions
        const button = document.querySelector(`#${type}Form button[type="submit"]`);
        button.innerHTML = `<i class="uil uil-spinner-alt animate-spin"></i> Processing...`;
        button.disabled = true;

        setTimeout(() => {
            document.querySelector(`#${type}Modal .btn-close`).click(); // Close modal
            showSuccessModal(actionText, amount, recipient);
        }, 1500); // Simulate delay
    }

    function showSuccessModal(actionText, amount, recipient) {
        const modalHtml = `
            <div class="modal fade" id="successModal" tabindex="-1" aria-labelledby="successModalLabel" aria-hidden="true">
                <div class="modal-dialog modal-dialog-centered">
                    <div class="modal-content">
                        <div class="modal-header">
                            <h5 class="modal-title text-success">✅ Transaction Successful</h5>
                            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                        </div>
                        <div class="modal-body text-center">
                            <h4>${actionText} Completed!</h4>
                            <p class="fs-5">You have successfully ${actionText.toLowerCase()}ed £${amount} ${recipient ? `to <strong>${recipient}</strong>` : ""}.</p>
                        </div>
                        <div class="modal-footer">
                            <button type="button" class="btn btn-primary" id="refreshDashboard">OK</button>
                        </div>
                    </div>
                </div>
            </div>
        `;

        document.body.insertAdjacentHTML("beforeend", modalHtml);
        const successModal = new bootstrap.Modal(document.getElementById("successModal"));
        successModal.show();

        document.getElementById("refreshDashboard").addEventListener("click", function () {
            location.reload(); // Refresh page
        });
    }

    // Event Listeners for Deposit & Transfer Buttons
    document.getElementById("depositButton").addEventListener("click", function () {
        showModal("deposit");
    });

    document.getElementById("transferButton").addEventListener("click", function () {
        showModal("transfer");
    });

});
</script>
  </body>


</html>